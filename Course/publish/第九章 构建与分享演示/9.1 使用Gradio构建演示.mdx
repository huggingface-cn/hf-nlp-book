## 9.1 ä½¿ç”¨Graadioæ„å»ºæ¼”ç¤º 

è®©æˆ‘ä»¬ä»å®‰è£… Gradio å¼€å§‹å§ï¼ç”±äºå®ƒæ˜¯ä¸€ä¸ª Python åŒ…ï¼Œåªéœ€è¿è¡Œï¼š
`$ pip install gradio` 

ä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹å®‰è£…å¹¶è¿è¡Œ Gradioï¼Œæ— è®ºæ˜¯ä»ä½ æœ€å–œæ¬¢çš„ Python IDEã€Jupyter notebook è¿˜æ˜¯ Google Colab ğŸ¤¯ï¼

è®©æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„â€œHello Worldâ€ç¤ºä¾‹å¼€å§‹ï¼Œç†Ÿæ‚‰ Gradio è¯­æ³•ï¼š

```python
import gradio as gr

def greet(name):
    return "Hello " + name

demo = gr.Interface(fn=greet, inputs="text", outputs="text")

demo.launch()
```

è®©æˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼š

- é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåä¸º `greet()` çš„å‡½æ•°ã€‚å®ƒæ˜¯ä¸€ä¸ªåœ¨ä½ çš„åå­—å‰æ·»åŠ â€œHelloâ€çš„ç®€å•å‡½æ•°ï¼Œä½†å®ƒé€šå¸¸å¯ä»¥æ˜¯ `ä»»ä½•` Python å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œåœ¨æœºå™¨å­¦ä¹ åº”ç”¨ç¨‹åºä¸­ï¼Œæ­¤å‡½æ•°å°† **è°ƒç”¨æ¨¡å‹ä»¥å¯¹è¾“å…¥è¿›è¡Œé¢„æµ‹** å¹¶è¿”å›è¾“å‡ºã€‚
- ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ä¸‰ä¸ªå‚æ•°çš„ Gradio `Interface` ï¼ŒåŒ…æ‹¬ `fn` ã€ `inputs` å’Œ `outputs` ã€‚è¿™äº›å‚æ•°å®šä¹‰äº†é¢„æµ‹å‡½æ•°ï¼Œæˆ‘ä»¬æƒ³è¦çš„è¾“å…¥å’Œè¾“å‡ºç»„ä»¶çš„ `type` ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œä¸¤ä¸ªç»„ä»¶éƒ½æ˜¯ç®€å•çš„æ–‡æœ¬æ¡†ã€‚
- æœ€åï¼Œæˆ‘ä»¬åœ¨æˆ‘ä»¬åˆ›å»ºçš„ `Interface` ä¸Šè°ƒç”¨ `launch()` æ–¹æ³•ã€‚

å¦‚æœä½ è¿è¡Œè¿™æ®µä»£ç ï¼Œä¸‹é¢çš„ç•Œé¢ä¼šè‡ªåŠ¨å‡ºç°åœ¨ Jupyterï¼Colab notebook ä¸­ï¼Œæˆ–è€…åœ¨æµè§ˆå™¨ä¸­å¼¹å‡º ** [http://localhost:7860](http://localhost:7860)(http://localhost:7860) ** ã€‚

å¯ä»¥ä½¿ç”¨ä½ è‡ªå·±çš„å§“åæˆ–å…¶ä»–è¾“å…¥æ¥ä½¿ç”¨æ­¤ GUIï¼åœ¨è¿™ä¸ª GUI ä¸­ï¼ŒGradio è‡ªåŠ¨æ¨æ–­è¾“å…¥å‚æ•°çš„åç§° ï¼ˆ `name` ï¼‰å¹¶å°†å…¶åº”ç”¨ä¸ºæ–‡æœ¬æ¡†é¡¶éƒ¨çš„æ ‡ç­¾ã€‚å¦‚æœä½ æƒ³æ”¹å˜å®ƒæˆ–è€…ä»¥å…¶ä»–æ–¹å¼è‡ªå®šä¹‰æ–‡æœ¬æ¡†è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥å®ä¾‹åŒ–ä¸€ä¸ªè¡¨ç¤ºè¾“å…¥ç»„ä»¶çš„ç±»å¯¹è±¡ã€‚

å­¦ä¹ ä»¥ä¸‹ä¾‹å­ï¼š

```python
import gradio as gr

def greet(name):
    return "Hello " + name

## å°†æ–‡æœ¬æ¡†ç±»å®ä¾‹åŒ–
textbox = gr.Textbox(label="Type your name here:", placeholder="John Doe", lines=2)

gr.Interface(fn=greet, inputs=textbox, outputs="text").launch()
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¸¦æœ‰æ ‡ç­¾ã€å ä½ç¬¦å’Œä¸€ç»„è¡Œæ•°çš„è¾“å…¥æ–‡æœ¬æ¡†ã€‚ä½ å¯ä»¥å¯¹è¾“å‡ºæ–‡æœ¬æ¡†æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œä½†æˆ‘ä»¬ç°åœ¨å°†å…¶ä¿ç•™ã€‚

æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œåªéœ€å‡ è¡Œä»£ç ï¼ŒGradio å°±å¯ä»¥è®©ä½ å›´ç»•ä»»ä½•å…·æœ‰ä»»ä½•ç±»å‹è¾“å…¥æˆ–è¾“å‡ºçš„å‡½æ•°åˆ›å»ºä¸€ä¸ªç®€å•çš„ç•Œé¢ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ¡†å¼€å§‹ï¼Œä½†åœ¨æ¥ä¸‹æ¥çš„éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å…¶ä»–ç±»å‹çš„è¾“å…¥å’Œè¾“å‡ºã€‚ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹åœ¨ Gradio åº”ç”¨ç¨‹åºä¸­åŒ…å«ä¸€äº› NLPã€‚

### ğŸ¤– åŒ…æ‹¬æ¨¡å‹é¢„æµ‹ 

ç°åœ¨è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„ç•Œé¢ï¼Œè®©ä½ å¯ä»¥æ¼”ç¤ºåƒ GPT-2 è¿™æ ·çš„**æ–‡æœ¬ç”Ÿæˆ**æ¨¡å‹ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨ Transformers ä¸­çš„ `pipeline()` å‡½æ•°åŠ è½½æˆ‘ä»¬çš„æ¨¡å‹ã€‚
å¦‚æœä½ éœ€è¦å¿«é€Ÿå¤ä¹ ï¼Œä½ å¯ä»¥è¿”å›åˆ°ç¬¬ 1 ç« ä¸­çš„é‚£ä¸ªéƒ¨åˆ†ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ¥å—æ–‡æœ¬æç¤ºå¹¶è¿”å›æ–‡æœ¬å®Œæˆçš„é¢„æµ‹å‡½æ•°ï¼š

```python
from transformers import pipeline

model = pipeline("text-generation")

def predict(prompt):
    completion = model(prompt)[0]["generated_text"]
    return completion
```

æ­¤å‡½æ•°å®Œæˆä½ æä¾›çš„æç¤ºï¼Œä½ å¯ä»¥ä½¿ç”¨è‡ªå·±çš„è¾“å…¥æç¤ºè¿è¡Œå®ƒä»¥æŸ¥çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼ˆä½ å¯èƒ½ä¼šå¾—åˆ°ä¸åŒçš„å®Œæˆï¼‰ï¼š

```python
predict("My favorite programming language is")
```

```python
>> My favorite programming language is Haskell. I really enjoyed the Haskell language, but it doesn't have all the features that can be applied to any other language. For example, all it does is compile to a byte array.
```

ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªç”Ÿæˆé¢„æµ‹çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åƒä¹‹å‰ä¸€æ ·åˆ›å»ºå’Œå¯åŠ¨ä¸€ä¸ªâ€œæ¥å£â€ï¼š

```python
import gradio as gr

gr.Interface(fn=predict, inputs="text", outputs="text").launch()
```

å°±æ˜¯è¿™æ ·ï¼ä½ ç°åœ¨å¯ä»¥ä½¿ç”¨æ­¤æ¥å£ä½¿ç”¨ GPT-2 æ¨¡å‹ç”Ÿæˆæ–‡æœ¬ï¼Œå¦‚ä¸‹æ‰€ç¤º ğŸ¤¯:

ç»§ç»­é˜…è¯»ä»¥äº†è§£å¦‚ä½•ä½¿ç”¨ Gradio æ„å»ºå…¶ä»–ç±»å‹çš„æ¼”ç¤ºï¼